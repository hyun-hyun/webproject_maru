{{>layouts/header}}

<div class="container">
<h4>Animation</h4>
<br>

{{#article}}

<div class="row g-2">
  <div class="col-md-6">
    <label class="form-label"><h1> {{title}}</h1></label><br>
    <label class="form-label">장르 </label> <b>{{genre}}</b><br>
    <label class="form-label">방영 </label> <b>{{broad_date}}</b><br>
    <label class="form-label">제작 </label> <b>{{ani_company}}</b><br>
    <label class="form-label">원작 </label> <b>{{author}}</b><br>
    <label class="form-label"><b>줄거리</b></label><br>
    {{story}}
    <br>
  </div>

  <div class="col-md-5" align="center">
  <img src="../../images/pic/anime/{{main_pic}}" class="addImage" alt="작품표지"></img>
    <br>
  </div>
</div>
<br>
<!--tag-->
    <ul>
      {{#tagSelectionCounts}}
          <span class="btn btn-outline-info btn-round m-1" > <b>{{tagName}}</b> : {{count}}</span>
          <input type="checkbox" id="tag_{{id}}" name="tags" value="{{id}}" style="display:none;">
          <!--m 모든방향 마진 mb-0~5 아래, mt 위 ml, mr 등 있음-->
          <!--<button type="button" onclick="toggleTag({{id}})">Toggle</button>-->
      {{/tagSelectionCounts}}
    </ul>

<br>

<!--종합추천점수-->
<label class="form-label">종합추천점수</label>
<button type="button" onclick="alert('사이즈지정해서 평가결과 뜨게하기')"class="btn btn-primary">자세히보기</button>
<br>
<br>
<label class="form-label">등장인물</label>
<br>
<div class="image-container" align="center">
  {{#subPics}}
  <div class="image-item">
    <img src="../../images/pic/anime/{{pic}}" class="addImage_m" alt="등장인물">
    {{realChar}}<br>
    <div class="gray-text">{{realVoiceChar}}</div>
    {{korChar}}<br>
    <div class="gray-text">{{korVoiceChar}}</div>
  </div>
  {{/subPics}}

</div>
<br> 

<hr>
<br>
{{>articles/showDetail/showReview}}
<hr>
<br>
{{>articles/showDetail/showComment}}

{{#write}}
  <a href="/write/article/anime/{{id}}/edit" class="btn btn-sm btn-primary">작품 수정</a>
  <a href="#" class="btn btn-sm btn-outline-danger" onclick="confirmDelete('{{id}}', false)">작품 삭제</a>
{{/write}}
{{#admin}}
  <a href="#" class="btn btn-sm btn-outline-danger admin" onclick="confirmDelete('{{id}}', true)">작품 삭제(관리자 권한)</a>
{{/admin}}
  <a href="/articles/anime" class="btn btn-sm btn-success">작품 목록</a>
{{/article}}
  
</div>


<script>

    {
      //게시글삭제버튼
      function confirmDelete(articleId, isAdmin) {
        if (confirm("정말로 이 작품을 삭제하시겠습니까?")) {
          const url=`/write/article/anime/${articleId}/delete?admin=${isAdmin}`;

            fetch(url, {
                method: 'POST'
            }).then(response => {
              return response.json().then(data => {
                console.log(response);
                   if (!response.ok) {
                      alert(data.error);
                      window.location.reload();
                  } else {
                      alert(data.message); // 삭제 완료 메시지
                      window.location.href = `/articles/anime`; // 목록 페이지로 이동
                  }
              });
          })
          .catch(error => {
              alert("오류가 발생했습니다: " + error);
          });
        }
    }
    }
</script>


{{>layouts/footer}}