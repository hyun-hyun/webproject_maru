{{>layouts/header}}

<div class="container">
<h4>ğŸ“–</h4>
<br>

{{#article}}

<div class="row g-2">
  <div class="col-md-6">
    <!--ì°œë²„íŠ¼ ìœ„ì¹˜-->
    {{#member_id}}
    <div>
      <button 
        id="love-btn-{{id}}" 
        class="love-button {{#isLoved}}active{{/isLoved}}" 
        onclick="toggleLove({{id}})">
        â™¥ë´ì•¼ì§€â™¥
      </button>
    </div>
    {{/member_id}}
    <label class="form-label"><h1> {{title}}</h1></label><br>
    <label class="form-label">ì¥ë¥´ </label> <b>{{genre}}</b><br>
    <label class="form-label">ë°©ì˜ </label> <b>{{broaddate}}</b><br>
    <label class="form-label">ì œì‘ </label> <b>{{ani_company}}</b><br>
    <label class="form-label">ì›ì‘ </label> <b>{{author}}</b><br>
    <label class="form-label"><b>ì¤„ê±°ë¦¬</b></label><br>
    {{story}}
    <br>
  </div>

  <div class="col-md-5" align="center">
  <img src="../../images/pic/anime/{{main_pic}}" class="addImage" alt="ì‘í’ˆí‘œì§€"></img>
    <br>
  </div>
</div>
<br>
<!--tag-->
    <ul>
      {{#tagSelectionCounts}}
          <span class="btn btn-outline-info btn-round m-1" > <b>{{tagName}}</b> : {{count}}</span>
          <input type="checkbox" id="tag_{{id}}" name="tags" value="{{id}}" style="display:none;">
          <!--m ëª¨ë“ ë°©í–¥ ë§ˆì§„ mb-0~5 ì•„ë˜, mt ìœ„ ml, mr ë“± ìˆìŒ-->
          <!--<button type="button" onclick="toggleTag({{id}})">Toggle</button>-->
      {{/tagSelectionCounts}}
    </ul>

<br>

<!--ì¢…í•©ì¶”ì²œì ìˆ˜
<label class="form-label">ì¢…í•©ì¶”ì²œì ìˆ˜</label>
<button type="button" onclick="alert('ì‚¬ì´ì¦ˆì§€ì •í•´ì„œ í‰ê°€ê²°ê³¼ ëœ¨ê²Œí•˜ê¸°')"class="btn btn-primary">ìì„¸íˆë³´ê¸°</button>-->
<br>
<br>
<label class="form-label">ë“±ì¥ì¸ë¬¼</label>
<br>
<div class="image-container" align="center">
  {{#subPics}}
  <div class="image-item">
    <img src="../../images/pic/anime/{{pic}}" class="addImage_m" alt="ë“±ì¥ì¸ë¬¼">
    {{realChar}}<br>
    <div class="gray-text">{{realVoiceChar}}</div>
    {{korChar}}<br>
    <div class="gray-text">{{korVoiceChar}}</div>
  </div>
  {{/subPics}}

</div>
<br> 

<hr>
<br>
{{>articles/showDetail/showReview}}
<hr>
<br>
{{>articles/showDetail/showComment}}

{{#write}}
  <a href="/write/article/anime/{{id}}/edit" class="btn btn-sm btn-primary">ì‘í’ˆ ìˆ˜ì •</a>
  <a href="#" class="btn btn-sm btn-outline-danger" onclick="confirmDelete('{{id}}', false)">ì‘í’ˆ ì‚­ì œ</a>
{{/write}}
{{#admin}}
  <a href="#" class="btn btn-sm btn-outline-danger admin" onclick="confirmDelete('{{id}}', true)">ì‘í’ˆ ì‚­ì œ(ê´€ë¦¬ì ê¶Œí•œ)</a>
{{/admin}}
  <a href="/articles/anime" class="btn btn-sm btn-success">ì‘í’ˆ ëª©ë¡</a>
{{/article}}
  
</div>


<script>
  //ì°œë²„íŠ¼ í´ë¦­
  function toggleLove(articleId) {
    const button = document.getElementById(`love-btn-${articleId}`);
    const isLoved = button.classList.contains('btn-danger');

    fetch(`/user/${articleId}/love`, {
      method: 'POST',
      headers: {
          'Content-Type': 'application/json'
      },
    })
    .then(response => response.json())
    .then(data => {
      if (data.success) {
          // ë²„íŠ¼ ìƒíƒœ í† ê¸€
          button.classList.toggle('active');

      } else {
          alert(data.message || "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.");
      }
  })
    .catch(error => {
        console.error("Error:", error);
        alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
    });
}

    {
      //ê²Œì‹œê¸€ì‚­ì œë²„íŠ¼
      function confirmDelete(articleId, isAdmin) {
        if (confirm("ì •ë§ë¡œ ì´ ì‘í’ˆì„ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
          const url=`/write/article/anime/${articleId}/delete?admin=${isAdmin}`;

            fetch(url, {
                method: 'POST'
            })
            .then(response => response.json())
            .then(isLoved => {
                const loveButton = document.getElementById('loveButton');
                const loveButtonText = document.getElementById('loveButtonText');
                if (isLoved) {
                    loveButton.classList.add('btn-danger');
                    loveButton.classList.remove('btn-outline-danger');
                } else {
                    loveButton.classList.add('btn-outline-danger');
                    loveButton.classList.remove('btn-danger');
                }
            })
          .catch(error => {
              alert("ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + error);
          });
        }
    }
    }
</script>
<style>
  //ì°œë²„íŠ¼
  /* ë²„íŠ¼ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
.love-button {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 5px;
    padding: 10px 15px;
    font-size: 16px;
    font-weight: bold;
    color: #ff6b6b; /* íŠ¸ë Œë””í•œ ë¹¨ê°„ìƒ‰ */
    background: #fff;
    border: 2px solid #ff6b6b;
    border-radius: 30px; /* ë™ê¸€ê²Œ */
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

/* ë²„íŠ¼ í˜¸ë²„ ìŠ¤íƒ€ì¼ */
.love-button:hover {
    background: #ff6b6b;
    color: #fff;
    box-shadow: 0 6px 12px rgba(255, 107, 107, 0.5);
}

/* ë²„íŠ¼ í™œì„±í™” ìŠ¤íƒ€ì¼ */
.love-button.active {
    background: #ff6b6b;
    color: #fff;
    box-shadow: 0 6px 12px rgba(255, 107, 107, 0.5);
}

/* í´ë¦­ ì‹œ ë²„íŠ¼ ì• ë‹ˆë©”ì´ì…˜ */
.love-button:active {
    transform: scale(0.95); /* ì‚´ì§ ì‘ì•„ì§ */
}
</style>

{{>layouts/footer}}